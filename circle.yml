machine:
  node:
    version: 5.1.0
    
dependencies:
  override:
    - npm install
    - npm install -g react-native-cli
    - sudo pip install awscli

test:
  override:
    - npm test
    - react-native bundle --minify --dev false --entry-file index.ios.js --platform ios --bundle-output ios/Chat/main_${CIRCLE_BRANCH}.jsbundle

deployment:
  production:
    branch: master
    commands:
      - aws s3 cp ios/Chat/main_${CIRCLE_BRANCH}.jsbundle s3://rn-chat/main_${CIRCLE_BRANCH}.jsbundle --acl public-read